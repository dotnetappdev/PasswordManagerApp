<Page x:Class="PasswordManager.WinUi.Views.LoginPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource ModernBackgroundBrush}"
      Loaded="Page_Loaded">

    <!-- Full window overlay that prevents interaction with background -->
    <Grid HorizontalAlignment="Stretch" 
          VerticalAlignment="Stretch"
          Background="{StaticResource ModernBackgroundBrush}">

        <!-- Content Container -->
        <Grid HorizontalAlignment="Center"
              VerticalAlignment="Center"
              MaxWidth="480">

            <Border Style="{StaticResource ModernElevatedCardStyle}"
                    Background="{StaticResource ModernSurfaceBrush}">

                <StackPanel Spacing="32">

                    <!-- Header Section -->
                    <StackPanel Spacing="16"
                            HorizontalAlignment="Center">
                        <!-- App Logo -->
                        <Border Background="{StaticResource ModernPrimaryGradientBrush}"
                                CornerRadius="20"
                                Width="64"
                                Height="64"
                                HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xE192;"
                                      FontSize="32"
                                      Foreground="White"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                        </Border>

                        <!-- App Title -->
                        <StackPanel HorizontalAlignment="Center"
                                Spacing="8">
                            <TextBlock Text="Password Manager"
                                       Style="{StaticResource ModernHeading2Style}"
                                       HorizontalAlignment="Center"/>
                            <TextBlock Text="Secure your digital life"
                                       Style="{StaticResource ModernCaptionStyle}"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Master Password Form -->
                    <StackPanel Spacing="24">

                        <!-- Dynamic Page Title -->
                        <TextBlock Text="{Binding PageTitle}"
                                   Style="{StaticResource ModernHeading3Style}"
                                   HorizontalAlignment="Center"/>

                        <!-- Form Fields -->
                        <StackPanel Spacing="20">
                            <!-- Master Password Input -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="{Binding PasswordLabel}"
                                           Style="{StaticResource ModernCaptionStyle}"
                                           FontWeight="SemiBold"/>
                                <PasswordBox x:Name="MasterPasswordBox"
                                            x:FieldModifier="private"
                                            PlaceholderText="{Binding PasswordPlaceholder}"
                                            Style="{StaticResource ModernPasswordBoxStyle}"/>
                            </StackPanel>

                            <!-- Confirm Password Input (First-time setup only) -->
                            <StackPanel Spacing="8"
                                       Visibility="{Binding ShowConfirmPassword, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="Confirm Master Password"
                                           Style="{StaticResource ModernCaptionStyle}"
                                           FontWeight="SemiBold"/>
                                <PasswordBox x:Name="ConfirmPasswordBox"
                                            x:FieldModifier="private"
                                            PlaceholderText="Confirm your master password"
                                            Style="{StaticResource ModernPasswordBoxStyle}"/>
                            </StackPanel>

                            <!-- Password Hint Input (First-time setup only) -->
                            <StackPanel Spacing="8"
                                       Visibility="{Binding ShowPasswordHint, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="Password Hint (Optional)"
                                           Style="{StaticResource ModernCaptionStyle}"
                                           FontWeight="SemiBold"/>
                                <TextBox x:Name="PasswordHintBox"
                                        x:FieldModifier="private"
                                        PlaceholderText="Enter a hint to help remember your password"
                                        Text="{Binding PasswordHint, Mode=TwoWay}"
                                        Style="{StaticResource ModernTextBoxStyle}"/>
                            </StackPanel>

                            <!-- Error Message -->
                            <Border Background="#FEF2F2"
                                    BorderBrush="{StaticResource ModernErrorBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16,12"
                                    Visibility="{Binding HasError, Converter={StaticResource BoolToVisibilityConverter}}">
                                <StackPanel Orientation="Horizontal"
                                        Spacing="8">
                                    <FontIcon Glyph="&#xE783;"
                                              FontSize="16"
                                              Foreground="{StaticResource ModernErrorBrush}"/>
                                    <TextBlock Text="{Binding ErrorMessage}"
                                               Foreground="{StaticResource ModernErrorBrush}"
                                               TextWrapping="Wrap"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Action Buttons -->
                        <StackPanel Spacing="16">
                            <!-- Primary Action Button (Dynamic Text) -->
                            <Button x:Name="PrimaryActionButton"
                                    x:FieldModifier="private"
                                    Content="{Binding PrimaryButtonText}"
                                    Style="{StaticResource ModernPrimaryButtonStyle}"
                                    HorizontalAlignment="Stretch"
                                    MinHeight="48"
                                    Click="PrimaryActionButton_Click"/>

                            <!-- Progress Ring -->
                            <ProgressRing x:Name="AuthProgressRing"
                                    x:FieldModifier="private"
                                          IsActive="{Binding IsLoading}"
                                          HorizontalAlignment="Center"
                                          Width="32"
                                          Height="32"/>
                        </StackPanel>

                    </StackPanel>

                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Page>