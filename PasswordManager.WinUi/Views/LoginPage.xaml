<Page x:Class="PasswordManager.WinUi.Views.LoginPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="#2D2D2D"
      Loaded="Page_Loaded">

    <!-- Full window dark background -->
    <Grid HorizontalAlignment="Stretch" 
          VerticalAlignment="Stretch"
          Background="#2D2D2D">

        <!-- Split Layout: Left side for branding, Right side for login -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="400"/>
            </Grid.ColumnDefinitions>

            <!-- Left Side: App Branding -->
            <Grid Grid.Column="0" 
                  Background="#2D2D2D">
                <StackPanel HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Spacing="32">
                    
                    <!-- Large App Icon -->
                    <Border Background="#4A90E2"
                            CornerRadius="32"
                            Width="120"
                            Height="120"
                            HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE192;"
                                  FontSize="60"
                                  Foreground="White"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                    </Border>

                    <!-- App Title -->
                    <StackPanel HorizontalAlignment="Center"
                                Spacing="8">
                        <TextBlock Text="Password Manager"
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="White"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Secure your digital life"
                                   FontSize="16"
                                   Foreground="#B0B0B0"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </Grid>

            <!-- Right Side: Login Form -->
            <Border Grid.Column="1"
                    Background="#404040"
                    Padding="0">
                
                <Grid>
                    <StackPanel HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               MaxWidth="320"
                               Spacing="32">

                        <!-- User Avatar and Welcome -->
                        <StackPanel HorizontalAlignment="Center"
                                   Spacing="16">
                            <!-- User Avatar -->
                            <Border Background="#8B7355"
                                    CornerRadius="32"
                                    Width="80"
                                    Height="80"
                                    HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ‘¤"
                                          FontSize="40"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>

                            <!-- Welcome Text -->
                            <TextBlock Text="{Binding PageTitle, FallbackValue='Welcome back'}"
                                       FontSize="20"
                                       FontWeight="SemiBold"
                                       Foreground="White"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Master Password Form -->
                        <StackPanel Spacing="24" 
                                   HorizontalAlignment="Stretch">

                            <!-- Password Input -->
                            <StackPanel Spacing="8">
                                <Border Background="#505050"
                                       CornerRadius="8"
                                       Padding="16,12"
                                       MinHeight="48">
                                    <PasswordBox x:Name="MasterPasswordBox"
                                                x:FieldModifier="private"
                                                PlaceholderText="Enter your password"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Foreground="White"
                                                FontSize="16"
                                                KeyDown="MasterPasswordBox_KeyDown"/>
                                </Border>
                                
                                <!-- Lock Status Text -->
                                <TextBlock Text="Password Manager was locked manually."
                                          FontSize="13"
                                          Foreground="#B0B0B0"
                                          HorizontalAlignment="Center"
                                          Visibility="{Binding ShowLockMessage, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </StackPanel>

                            <!-- Confirm Password Input (First-time setup only) -->
                            <StackPanel Spacing="8"
                                       Visibility="{Binding ShowConfirmPassword, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Border Background="#505050"
                                       CornerRadius="8"
                                       Padding="16,12"
                                       MinHeight="48">
                                    <PasswordBox x:Name="ConfirmPasswordBox"
                                                x:FieldModifier="private"
                                                PlaceholderText="Confirm your master password"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Foreground="White"
                                                FontSize="16"/>
                                </Border>
                            </StackPanel>

                            <!-- Password Hint Input (First-time setup only) -->
                            <StackPanel Spacing="8"
                                       Visibility="{Binding ShowPasswordHint, Converter={StaticResource BoolToVisibilityConverter}}">
                                <Border Background="#505050"
                                       CornerRadius="8"
                                       Padding="16,12"
                                       MinHeight="48">
                                    <TextBox x:Name="PasswordHintBox"
                                            x:FieldModifier="private"
                                            PlaceholderText="Enter a hint to help remember your password"
                                            Text="{Binding PasswordHint, Mode=TwoWay}"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Foreground="White"
                                            FontSize="16"/>
                                </Border>
                            </StackPanel>

                            <!-- Error Message -->
                            <Border Background="#5D2A2A"
                                    BorderBrush="#DC2626"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16,12"
                                    Visibility="{Binding HasError, Converter={StaticResource BoolToVisibilityConverter}}">
                                <StackPanel Orientation="Horizontal"
                                            Spacing="8">
                                    <FontIcon Glyph="&#xE783;"
                                              FontSize="16"
                                              Foreground="#DC2626"/>
                                    <TextBlock Text="{Binding ErrorMessage}"
                                               Foreground="#FCA5A5"
                                               TextWrapping="Wrap"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <!-- Action Button -->
                            <Button x:Name="PrimaryActionButton"
                                    x:FieldModifier="private"
                                    Content="{Binding PrimaryButtonText, FallbackValue='Unlock'}"
                                    Background="#4A90E2"
                                    Foreground="White"
                                    BorderThickness="0"
                                    CornerRadius="8"
                                    HorizontalAlignment="Stretch"
                                    MinHeight="48"
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    IsEnabled="{Binding IsButtonEnabled}"
                                    Click="PrimaryActionButton_Click"/>

                            <!-- Progress Ring -->
                            <ProgressRing x:Name="AuthProgressRing"
                                         x:FieldModifier="private"
                                         IsActive="{Binding IsLoading}"
                                         HorizontalAlignment="Center"
                                         Width="32"
                                         Height="32"
                                         Foreground="#4A90E2"/>

                            <!-- Additional Options -->
                            <StackPanel Spacing="12"
                                       HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ˜Š"
                                          FontSize="24"
                                          HorizontalAlignment="Center"
                                          Visibility="Collapsed"/>
                                
                                <!-- Password Hint Display -->
                                <Button Content="Show password hint"
                                       Background="Transparent"
                                       BorderThickness="0"
                                       Foreground="#8B8B8B"
                                       FontSize="13"
                                       HorizontalAlignment="Center"
                                       Visibility="{Binding ShowHintButton, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </StackPanel>
                        </StackPanel>

                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Page>