<Page x:Class="PasswordManager.WinUi.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ScrollViewer>
        <StackPanel Padding="20" Spacing="24">
            <TextBlock Text="Settings" 
                      FontSize="24" 
                      FontWeight="Bold"/>
            
            <!-- Security Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="ðŸ” Security" 
                          FontSize="18" 
                          FontWeight="SemiBold"/>
                
                <ToggleSwitch x:Name="TwoFactorToggle"
                             Header="Enable Two-Factor Authentication" 
                             IsOn="{Binding EnableTwoFactor, Mode=TwoWay}"
                             Toggled="TwoFactorToggle_Toggled"/>
                
                <ToggleSwitch x:Name="PasscodeToggle"
                             Header="Require Passcode on Startup" 
                             IsOn="{Binding RequirePasscode, Mode=TwoWay}"
                             Toggled="PasscodeToggle_Toggled"/>
                
                <Button x:Name="ChangePasswordButton"
                       Content="ðŸ”‘ Change Master Password" 
                       HorizontalAlignment="Left"
                       Click="ChangePasswordButton_Click"/>
                
                <ComboBox x:Name="SessionTimeoutComboBox"
                         Header="Session Timeout (minutes)"
                         ItemsSource="{Binding TimeoutOptions}"
                         SelectedItem="{Binding SessionTimeoutMinutes, Mode=TwoWay}"
                         SelectionChanged="SessionTimeoutComboBox_SelectionChanged"
                         MinWidth="150"/>
            </StackPanel>
            
            <!-- Database Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="ðŸ—„ï¸ Authentication & Storage" 
                          FontSize="18" 
                          FontWeight="SemiBold"/>
                
                <ComboBox x:Name="AuthModeComboBox"
                         Header="Authentication Mode"
                         ItemsSource="{Binding AuthenticationModes}"
                         SelectedItem="{Binding AuthenticationMode, Mode=TwoWay}"
                         SelectionChanged="AuthModeComboBox_SelectionChanged"
                         MinWidth="200"/>
                
                <StackPanel x:Name="ApiSettingsPanel" 
                           Spacing="8"
                           Visibility="{Binding AuthenticationMode, Converter={StaticResource ApiModeToVisibilityConverter}}">
                    <TextBlock Text="API Settings" FontWeight="SemiBold"/>
                    <TextBox x:Name="ApiUrlTextBox"
                            Header="API Base URL"
                            Text="{Binding ApiBaseUrl, Mode=TwoWay}"
                            PlaceholderText="https://localhost:7001/api"
                            MinWidth="300"/>
                    <TextBlock Text="Configure the base URL for the Password Manager API server." 
                              Style="{StaticResource CaptionTextBlockStyle}" 
                              TextWrapping="Wrap"/>
                </StackPanel>

                <ComboBox Header="Database Provider (Local Mode Only)" 
                         PlaceholderText="Select provider"
                         IsEnabled="{Binding AuthenticationMode, Converter={StaticResource LocalModeToEnabledConverter}}"
                         MinWidth="200">
                    <ComboBoxItem Content="SQLite" IsSelected="True"/>
                    <ComboBoxItem Content="SQL Server"/>
                    <ComboBoxItem Content="MySQL"/>
                    <ComboBoxItem Content="PostgreSQL"/>
                </ComboBox>
                
                <Button Content="ðŸ“Š Configure Database Connection" 
                       HorizontalAlignment="Left"
                       IsEnabled="{Binding AuthenticationMode, Converter={StaticResource LocalModeToEnabledConverter}}"
                       Click="ConfigureDatabaseButton_Click"/>
                
                <ToggleSwitch x:Name="SyncToggle"
                             Header="Enable Cloud Sync" 
                             IsOn="{Binding EnableSync, Mode=TwoWay}"
                             Toggled="SyncToggle_Toggled"/>
            </StackPanel>
            
            <!-- Import/Export Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="ðŸ’¾ Import/Export" 
                          FontSize="18" 
                          FontWeight="SemiBold"/>
                
                <StackPanel Spacing="8">
                    <TextBlock Text="Export Path:" Style="{StaticResource CaptionTextBlockStyle}"/>
                    <TextBox Text="{Binding ExportPath, Mode=TwoWay}" 
                            IsReadOnly="True" 
                            MinWidth="300"/>
                    <Button Content="ðŸ“‚ Choose Export Folder" 
                           HorizontalAlignment="Left"
                           Click="ChooseExportFolderButton_Click"/>
                </StackPanel>
                
                <Button x:Name="ExportButton"
                       Content="ðŸ“¤ Export All Passwords" 
                       HorizontalAlignment="Left"
                       Click="ExportButton_Click"
                       IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                
                <Button Content="ðŸ“¥ Go to Import Page" 
                       HorizontalAlignment="Left"
                       Click="ImportButton_Click"/>
            </StackPanel>
            
            <!-- Appearance Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="ðŸŽ¨ Appearance" 
                          FontSize="18" 
                          FontWeight="SemiBold"/>
                
                <ComboBox x:Name="ThemeComboBox"
                         Header="Theme" 
                         ItemsSource="{Binding AvailableThemes}"
                         SelectedItem="{Binding SelectedTheme, Mode=TwoWay}"
                         SelectionChanged="ThemeComboBox_SelectionChanged"
                         MinWidth="150"/>
            </StackPanel>
            
            <!-- Data Management -->
            <StackPanel Spacing="12">
                <TextBlock Text="ðŸ—‘ï¸ Data Management" 
                          FontSize="18" 
                          FontWeight="SemiBold"/>
                
                <Button x:Name="ClearDataButton"
                       Content="âš ï¸ Clear All Data" 
                       Background="Red"
                       Foreground="White"
                       HorizontalAlignment="Left"
                       Click="ClearDataButton_Click"/>
                
                <TextBlock Text="This will permanently delete all your stored passwords and settings." 
                          FontSize="12" 
                          Foreground="Red"
                          TextWrapping="Wrap"
                          MaxWidth="400"/>
            </StackPanel>
            
            <!-- Loading Indicator -->
            <StackPanel HorizontalAlignment="Center" 
                       Spacing="10"
                       Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
                <ProgressRing IsActive="True" Width="30" Height="30"/>
                <TextBlock Text="Saving settings..." FontSize="14"/>
            </StackPanel>
            
        </StackPanel>
    </ScrollViewer>
</Page>